// –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ —Ç–µ–º–∞–º–∏ –ø–æ BI
import { Pool } from 'pg';
import dotenv from 'dotenv';
import path from 'path';

dotenv.config({ path: path.join(__dirname, '../../.env') });

const pool = new Pool({
  host: process.env.DB_HOST || '127.0.0.1',
  port: parseInt(process.env.DB_PORT || '5432'),
  database: process.env.DB_NAME || 'forum_db',
  user: process.env.DB_USER || 'postgres',
  password: process.env.DB_PASSWORD || 'rootroot',
});

interface Category {
  name: string;
  description: string;
  sampleTopics?: Array<{ title: string; content: string }>;
}

const biCategories: Category[] = [
  {
    name: '–•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö (Data Warehousing)',
    description: '–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã DWH, –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö, best practices.',
    sampleTopics: [
      {
        title: '–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö?',
        content: '–ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã DWH? Kimball vs Inmon, –∫–æ–≥–¥–∞ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?'
      },
      {
        title: '–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –±–æ–ª—å—à–∏—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â',
        content: '–ö–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö? –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–Ω–¥–µ–∫—Å—ã, –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.'
      }
    ]
  },
  {
    name: 'ETL –ø—Ä–æ—Ü–µ—Å—Å—ã',
    description: '–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã ETL, –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫.',
    sampleTopics: [
      {
        title: '–õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ETL –ø–∞–π–ø–ª–∞–π–Ω–æ–≤',
        content: '–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ETL –ø—Ä–æ—Ü–µ—Å—Å? –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥.'
      },
      {
        title: '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ ETL –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤',
        content: 'SSIS, Talend, Pentaho, Apache Airflow - –∫–∞–∫–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤—ã–±—Ä–∞—Ç—å –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞?'
      }
    ]
  },
  {
    name: '–û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∏ –¥–∞—à–±–æ—Ä–¥—ã',
    description: '–°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤, –¥–∞—à–±–æ—Ä–¥–æ–≤ –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–∞–Ω–µ–ª–µ–π. Power BI, Tableau, QlikView, SSRS –∏ –¥—Ä—É–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.',
    sampleTopics: [
      {
        title: '–°–æ–∑–¥–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤',
        content: '–ü—Ä–∏–Ω—Ü–∏–ø—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –¥–∞—à–±–æ—Ä–¥–∞—Ö. –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –¥–∞—à–±–æ—Ä–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º?'
      },
      {
        title: '–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏',
        content: '–ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏ —Ä–∞—Å—Å—ã–ª–∫—É –æ—Ç—á–µ—Ç–æ–≤? –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø–æ–¥–ø–∏—Å–∫–∏.'
      }
    ]
  },
  {
    name: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ BI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã',
    description: '–û–±—Å—É–∂–¥–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö BI –ø–ª–∞—Ç—Ñ–æ—Ä–º –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. Power BI, Tableau, Qlik, Looker, Metabase –∏ –¥—Ä—É–≥–∏–µ.',
    sampleTopics: [
      {
        title: 'Power BI vs Tableau - —á—Ç–æ –≤—ã–±—Ä–∞—Ç—å?',
        content: '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–≤—É—Ö –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö BI –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∫–∞–∂–¥–æ–≥–æ.'
      },
      {
        title: 'Open-source BI —Ä–µ—à–µ–Ω–∏—è',
        content: 'Metabase, Superset, Redash - –æ–±–∑–æ—Ä –æ—Ç–∫—Ä—ã—Ç—ã—Ö BI –ø–ª–∞—Ç—Ñ–æ—Ä–º. –ö–æ–≥–¥–∞ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?'
      }
    ]
  },
  {
    name: '–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö',
    description: '–ü—Ä–∏–Ω—Ü–∏–ø—ã –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –¢–∏–ø—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤, —Ü–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.',
    sampleTopics: [
      {
        title: '–í—ã–±–æ—Ä –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ç–∏–ø–∞ –≥—Ä–∞—Ñ–∏–∫–∞',
        content: '–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–Ω–µ–π–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏, –∫–æ–≥–¥–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã, –∫–æ–≥–¥–∞ –∫—Ä—É–≥–æ–≤—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã?'
      },
      {
        title: '–¶–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã –≤ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏',
        content: '–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–≤–µ—Ç–∞ –≤ –¥–∞—à–±–æ—Ä–¥–∞—Ö? –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å, –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å, —Ü–≤–µ—Ç–æ–≤–∞—è —Å–ª–µ–ø–æ—Ç–∞.'
      }
    ]
  },
  {
    name: 'OLAP –∏ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑',
    description: 'OLAP –∫—É–±—ã, –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö, MDX –∑–∞–ø—Ä–æ—Å—ã. –ê–Ω–∞–ª–∏–∑ –ø–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è–º –∏ –º–µ—Ç—Ä–∏–∫–∞–º.',
    sampleTopics: [
      {
        title: '–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ OLAP –∫—É–±–æ–≤',
        content: '–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å OLAP –∫—É–±? –í—ã–±–æ—Ä –∏–∑–º–µ—Ä–µ–Ω–∏–π, –∏–µ—Ä–∞—Ä—Ö–∏–π, –º–µ—Ä.'
      },
      {
        title: '–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è MDX –∑–∞–ø—Ä–æ—Å–æ–≤',
        content: '–ö–∞–∫ –ø–∏—Å–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ MDX –∑–∞–ø—Ä–æ—Å—ã? –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ best practices.'
      }
    ]
  },
  {
    name: 'Data Mining –∏ –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ',
    description: '–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –≤ BI. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è, –∞–Ω–æ–º–∞–ª–∏–∏.',
    sampleTopics: [
      {
        title: '–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ BI —Å–∏—Å—Ç–µ–º–∞—Ö',
        content: '–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–µ?'
      },
      {
        title: '–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö',
        content: '–ú–µ—Ç–æ–¥—ã –≤—ã—è–≤–ª–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π –∏ –≤—ã–±—Ä–æ—Å–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è.'
      }
    ]
  },
  {
    name: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ (Data Governance)',
    description: '–ü–æ–ª–∏—Ç–∏–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏, –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –∫–∞—Ç–∞–ª–æ–≥–∏ –¥–∞–Ω–Ω—ã—Ö, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.',
    sampleTopics: [
      {
        title: '–í–Ω–µ–¥—Ä–µ–Ω–∏–µ Data Governance',
        content: '–° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏? –†–æ–ª–∏, –ø—Ä–æ—Ü–µ—Å—Å—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.'
      },
      {
        title: '–û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö',
        content: '–ú–µ—Ç–æ–¥—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö. –í–∞–ª–∏–¥–∞—Ü–∏—è, –æ—á–∏—Å—Ç–∫–∞, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥.'
      }
    ]
  },
  {
    name: '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö',
    description: '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. API, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, real-time –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è.',
    sampleTopics: [
      {
        title: '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏',
        content: '–ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å real-time –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö? Change Data Capture, streaming, –æ—á–µ—Ä–µ–¥–∏.'
      },
      {
        title: '–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–±–ª–∞—á–Ω—ã—Ö –∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º',
        content: '–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –æ–±–ª–∞—á–Ω—ã–º–∏ –∏ on-premise —Å–∏—Å—Ç–µ–º–∞–º–∏.'
      }
    ]
  },
  {
    name: '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è',
    description: '–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ BI —Å–∏—Å—Ç–µ–º. –¢—é–Ω–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ.',
    sampleTopics: [
      {
        title: '–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤',
        content: '–ö–∞–∫ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏? –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–Ω–¥–µ–∫—Å—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.'
      },
      {
        title: '–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ BI —Å–∏—Å—Ç–µ–º',
        content: '–ö–∞–∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å BI —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏ —Ä–æ—Å—Ç–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π? –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ.'
      }
    ]
  },
  {
    name: '–û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã BI',
    description: '–û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–µ, –∫–∞—Ä—å–µ—Ä–∞ –≤ BI, –æ–±—É—á–µ–Ω–∏–µ, –Ω–æ–≤–æ—Å—Ç–∏ –∏ —Ç—Ä–µ–Ω–¥—ã –∏–Ω–¥—É—Å—Ç—Ä–∏–∏.',
    sampleTopics: [
      {
        title: '–° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å –∫–∞—Ä—å–µ—Ä—É –≤ BI?',
        content: '–ö–∞–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ BI? –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ? –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∫—É—Ä—Å—ã –∏ —Ä–µ—Å—É—Ä—Å—ã.'
      },
      {
        title: '–¢—Ä–µ–Ω–¥—ã –≤ BI –Ω–∞ 2024-2025',
        content: '–ö–∞–∫–∏–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –ø–æ–¥—Ö–æ–¥—ã –±—É–¥—É—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã –≤ –±–ª–∏–∂–∞–π—à–∏–µ –≥–æ–¥—ã? AI –≤ BI, –æ–±–ª–∞—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, self-service BI.'
      }
    ]
  }
];

async function seedCategories() {
  try {
    console.log('üå± –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ —Ç–µ–º–∞–º–∏ –ø–æ BI...\n');

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    await pool.query('SELECT 1');

    // –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–ª–∏ —Å–æ–∑–¥–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ, –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
    const usersResult = await pool.query('SELECT id FROM users ORDER BY id LIMIT 1');
    let authorId: number;

    if (usersResult.rows.length === 0) {
      console.log('‚ö†Ô∏è  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –°–æ–∑–¥–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
      const sysUserResult = await pool.query(
        `INSERT INTO users (username, email, password_hash, role) 
         VALUES ($1, $2, $3, $4) 
         RETURNING id`,
        ['system', 'system@forum.local', 'system', 'admin']
      );
      authorId = sysUserResult.rows[0].id;
      console.log('‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω');
    } else {
      authorId = usersResult.rows[0].id;
      console.log(`‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å ID: ${authorId}`);
    }

    let categoriesCreated = 0;
    let topicsCreated = 0;

    for (const category of biCategories) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è
      const existingCategory = await pool.query(
        'SELECT id FROM categories WHERE name = $1',
        [category.name]
      );

      let categoryId: number;

      if (existingCategory.rows.length > 0) {
        categoryId = existingCategory.rows[0].id;
        console.log(`‚è≠Ô∏è  –ö–∞—Ç–µ–≥–æ—Ä–∏—è "${category.name}" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º`);
      } else {
        // –°–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
        const categoryResult = await pool.query(
          'INSERT INTO categories (name, description) VALUES ($1, $2) RETURNING id',
          [category.name, category.description]
        );
        categoryId = categoryResult.rows[0].id;
        categoriesCreated++;
        console.log(`‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è: ${category.name}`);
      }

      // –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–º–µ—Ä–Ω—ã–µ —Ç–µ–º—ã, –µ—Å–ª–∏ –æ–Ω–∏ —É–∫–∞–∑–∞–Ω—ã
      if (category.sampleTopics) {
        for (const topic of category.sampleTopics) {
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ç–µ–º–∞
          const existingTopic = await pool.query(
            'SELECT id FROM topics WHERE title = $1 AND category_id = $2',
            [topic.title, categoryId]
          );

          if (existingTopic.rows.length === 0) {
            await pool.query(
              'INSERT INTO topics (title, content, author_id, category_id) VALUES ($1, $2, $3, $4)',
              [topic.title, topic.content, authorId, categoryId]
            );
            topicsCreated++;
            console.log(`   üìù –°–æ–∑–¥–∞–Ω–∞ —Ç–µ–º–∞: ${topic.title}`);
          }
        }
      }
    }

    console.log('\n‚ú® –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
    console.log(`üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:`);
    console.log(`   - –ö–∞—Ç–µ–≥–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω–æ: ${categoriesCreated}`);
    console.log(`   - –¢–µ–º —Å–æ–∑–¥–∞–Ω–æ: ${topicsCreated}`);
    console.log(`   - –í—Å–µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${biCategories.length}`);

    await pool.end();
    process.exit(0);
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:');
    console.error(error);
    await pool.end();
    process.exit(1);
  }
}

seedCategories();
