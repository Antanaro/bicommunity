# Решение проблем с подключением к PostgreSQL

## Ошибка: "password authentication failed for user postgres"

Эта ошибка означает, что пароль в файле `backend/.env` не совпадает с паролем пользователя `postgres` в PostgreSQL.

### Решение 1: Найти правильный пароль

Если вы забыли пароль PostgreSQL, попробуйте:

1. **Проверьте, какой пароль вы использовали при установке PostgreSQL**
   - Обычно пароль запрашивается при установке
   - Проверьте записи/документацию

2. **Попробуйте стандартные пароли:**
   - `postgres` (по умолчанию)
   - `admin`
   - `root`
   - Пустой пароль (оставьте поле пустым)

3. **Используйте pgAdmin для проверки:**
   - Откройте pgAdmin
   - Попробуйте подключиться к серверу
   - Если подключение успешно, значит пароль правильный

### Решение 2: Изменить пароль PostgreSQL

Если нужно изменить пароль пользователя `postgres`:

#### Через pgAdmin:
1. Откройте pgAdmin
2. Подключитесь к серверу (если знаете текущий пароль)
3. Правый клик на "Login/Group Roles" → "Create" → "Login/Group Role"
4. Или правый клик на существующем пользователе `postgres` → "Properties" → "Definition"
5. Установите новый пароль

#### Через psql (командная строка):
```sql
-- Подключитесь к PostgreSQL (может потребоваться другой пользователь)
psql -U postgres

-- Измените пароль
ALTER USER postgres WITH PASSWORD 'новый_пароль';
```

#### Через файл pg_hba.conf (если забыли пароль):
1. Найдите файл `pg_hba.conf` (обычно в `C:\Program Files\PostgreSQL\XX\data\`)
2. Временно измените метод аутентификации на `trust`:
   ```
   host    all             all             127.0.0.1/32            trust
   ```
3. Перезапустите службу PostgreSQL
4. Подключитесь без пароля и измените его:
   ```sql
   ALTER USER postgres WITH PASSWORD 'новый_пароль';
   ```
5. Верните `md5` в `pg_hba.conf` и перезапустите службу

### Решение 3: Обновить файл .env

После того как узнали правильный пароль:

1. Откройте файл `backend/.env`
2. Найдите строку: `DB_PASSWORD=postgres`
3. Замените `postgres` на ваш реальный пароль:
   ```
   DB_PASSWORD=ваш_реальный_пароль
   ```
4. Сохраните файл
5. Попробуйте снова запустить миграции

### Решение 4: Использовать другого пользователя

Если у вас есть другой пользователь PostgreSQL с известным паролем:

1. Откройте `backend/.env`
2. Измените:
   ```
   DB_USER=ваш_пользователь
   DB_PASSWORD=пароль_пользователя
   ```
3. Убедитесь, что у этого пользователя есть права на создание базы данных

### Проверка подключения

После изменения пароля проверьте подключение:

```bash
cd backend
npm run check-db
```

Или используйте `check-db.bat`

### Быстрая проверка через psql

Попробуйте подключиться напрямую:

```bash
psql -U postgres -h localhost -p 5432
```

Если подключение успешно, значит пароль правильный. Если нет - нужно изменить пароль в `.env` на тот, который работает.
