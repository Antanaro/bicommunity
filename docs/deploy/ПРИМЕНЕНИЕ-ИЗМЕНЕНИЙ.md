# Применение изменений после деплоя

## Проблема
После загрузки изменений на сервер (через git pull или копирование файлов) изменения не применяются, потому что Docker образы не пересобраны.

## Решение

### Вариант 1: Пересборка только nginx (рекомендуется, быстрее)

Если вы изменили только frontend:

```bash
# На сервере, в корне проекта
docker compose build nginx
docker compose up -d nginx
```

Или для старых версий Docker:
```bash
docker-compose build nginx
docker-compose up -d nginx
```

### Вариант 2: Пересборка всех сервисов

Если вы изменили и frontend, и backend:

```bash
# На сервере, в корне проекта
docker compose up -d --build
```

Или для старых версий Docker:
```bash
docker-compose up -d --build
```

### Вариант 3: Полная пересборка без кеша (если изменения не применяются)

Если предыдущие варианты не помогли:

```bash
# На сервере, в корне проекта
docker compose build --no-cache nginx
docker compose up -d nginx
```

Или для старых версий Docker:
```bash
docker-compose build --no-cache nginx
docker-compose up -d nginx
```

## Проверка

После пересборки проверьте:

1. Статус контейнеров:
```bash
docker compose ps
```

2. Логи nginx (если есть ошибки):
```bash
docker compose logs nginx
```

3. Откройте сайт в браузере и проверьте, что изменения применились.

## Почему это нужно?

Docker образы кешируются. Когда вы:
1. Закоммитили изменения в git
2. Перенесли на сервер (git pull)

Docker **не знает** об изменениях, потому что образ уже собран. Нужно явно пересобрать образ, чтобы:
- Установить новые зависимости (например, `react-markdown`, `remark-gfm`)
- Собрать новый frontend с изменениями
- Скопировать обновленные файлы в образ

## Быстрая команда для частых обновлений

Создайте скрипт `update-frontend.sh`:

```bash
#!/bin/bash
cd /path/to/project
docker compose build nginx
docker compose up -d nginx
echo "Frontend обновлен!"
```

Сделайте его исполняемым:
```bash
chmod +x update-frontend.sh
```

Затем просто запускайте:
```bash
./update-frontend.sh
```
